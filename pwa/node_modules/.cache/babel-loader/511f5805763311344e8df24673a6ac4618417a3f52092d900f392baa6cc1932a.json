{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\ADMIN\\\\FamilyBubble\\\\pwa\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nimport { auth } from './firebase';\nimport MainApp from './components/bubble/MainApp';\nimport Welcome from './components/auth/Welcome';\nimport Login from './components/auth/Login';\nimport JoinBubble from './components/auth/JoinBubble';\nimport CreateBubbleFlow from './components/auth/CreateBubbleFlow';\nimport Purchases from 'purchases-web';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function FamilyBubbleApp() {\n  _s();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [view, setView] = useState('welcome'); // welcome, login, join, create, main\n  const [joinToken, setJoinToken] = useState(null);\n  const [bubbleCreationData, setBubbleCreationData] = useState(null);\n  const [isPremium, setIsPremium] = useState(false); // New state for premium status\n\n  // Initialize RevenueCat SDK once when the component mounts\n  useEffect(() => {\n    const revenueCatApiKey = process.env.REACT_APP_REVENUECAT_PUBLIC_API_KEY; // Replace with your actual RevenueCat public API key from .env.local or your build process. Find it in RevenueCat Dashboard -> API Keys.\n\n    const unsubscribe = auth.onAuthStateChanged(async user => {\n      // Made async to await Purchases.getCustomerInfo()\n      setCurrentUser(user);\n      setLoading(false);\n      if (revenueCatApiKey && user && !Purchases.isConfigured) {\n        Purchases.configure({\n          apiKey: revenueCatApiKey,\n          appUserID: user.uid\n        });\n        console.log(\"RevenueCat SDK configured.\");\n      }\n      if (user) {\n        // Fetch RevenueCat customer info to determine premium status\n        try {\n          const customerInfo = await Purchases.getCustomerInfo();\n          if (customerInfo.entitlements.active.premium) {\n            // Assuming 'premium' is your entitlement ID\n            setIsPremium(true);\n            console.log(\"User is premium.\");\n          } else {\n            setIsPremium(false);\n            console.log(\"User is not premium.\");\n          }\n        } catch (e) {\n          console.error(\"Error fetching RevenueCat customer info:\", e);\n          setIsPremium(false); // Assume not premium on error\n        }\n        setView('main');\n      } else {\n        setIsPremium(false); // Reset premium status on logout\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n  const handleLogout = () => {\n    auth.signOut().then(() => {\n      setView('welcome');\n      setJoinToken(null);\n      setBubbleCreationData(null);\n    });\n  };\n  const handleLoginBack = () => {\n    if (joinToken) {\n      setView('join');\n    } else if (bubbleCreationData) {\n      setView('create');\n    } else {\n      setView('welcome');\n    }\n  };\n  const resetAuthFlow = () => {\n    setView('login');\n    setJoinToken(null);\n    setBubbleCreationData(null);\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-blue-950 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"w-16 h-16 border-4 border-t-transparent border-blue-500 rounded-full animate-spin\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this);\n  }\n  if (!currentUser) {\n    if (view === 'welcome') {\n      return /*#__PURE__*/_jsxDEV(Welcome, {\n        onLogin: resetAuthFlow,\n        onCreate: () => setView('create'),\n        onJoin: () => setView('join')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 14\n      }, this);\n    }\n    if (view === 'join') {\n      return /*#__PURE__*/_jsxDEV(JoinBubble, {\n        onJoin: token => {\n          setJoinToken(token);\n          setView('login');\n        },\n        onBack: () => setView('welcome')\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 14\n      }, this);\n    }\n    if (view === 'create') {\n      return /*#__PURE__*/_jsxDEV(CreateBubbleFlow, {\n        onComplete: data => {\n          setBubbleCreationData(data);\n          setView('login');\n        },\n        onBack: () => setView('welcome'),\n        isPremium: isPremium // Pass isPremium prop\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 101,\n        columnNumber: 14\n      }, this);\n    }\n    if (view === 'login') {\n      return /*#__PURE__*/_jsxDEV(Login, {\n        onLoginSuccess: () => setView('main'),\n        onBack: handleLoginBack\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 14\n      }, this);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"min-h-screen bg-gray-950\",\n    children: /*#__PURE__*/_jsxDEV(MainApp, {\n      userId: currentUser.uid,\n      onLogout: handleLogout,\n      joinToken: joinToken,\n      bubbleCreationData: bubbleCreationData,\n      onBubbleCreated: () => setBubbleCreationData(null)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 113,\n    columnNumber: 5\n  }, this);\n}\n_s(FamilyBubbleApp, \"S+AhwZCdgdDPigF1nfpPeDKqV/8=\");\n_c = FamilyBubbleApp;\nvar _c;\n$RefreshReg$(_c, \"FamilyBubbleApp\");","map":{"version":3,"names":["React","useState","useEffect","auth","MainApp","Welcome","Login","JoinBubble","CreateBubbleFlow","Purchases","jsxDEV","_jsxDEV","FamilyBubbleApp","_s","currentUser","setCurrentUser","loading","setLoading","view","setView","joinToken","setJoinToken","bubbleCreationData","setBubbleCreationData","isPremium","setIsPremium","revenueCatApiKey","process","env","REACT_APP_REVENUECAT_PUBLIC_API_KEY","unsubscribe","onAuthStateChanged","user","isConfigured","configure","apiKey","appUserID","uid","console","log","customerInfo","getCustomerInfo","entitlements","active","premium","e","error","handleLogout","signOut","then","handleLoginBack","resetAuthFlow","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onLogin","onCreate","onJoin","token","onBack","onComplete","data","onLoginSuccess","userId","onLogout","onBubbleCreated","_c","$RefreshReg$"],"sources":["C:/Users/ADMIN/FamilyBubble/pwa/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { auth } from './firebase';\nimport MainApp from './components/bubble/MainApp';\nimport Welcome from './components/auth/Welcome';\nimport Login from './components/auth/Login';\nimport JoinBubble from './components/auth/JoinBubble';\nimport CreateBubbleFlow from './components/auth/CreateBubbleFlow';\nimport Purchases from 'purchases-web';\n\nexport default function FamilyBubbleApp() {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [view, setView] = useState('welcome'); // welcome, login, join, create, main\n  const [joinToken, setJoinToken] = useState(null);\n  const [bubbleCreationData, setBubbleCreationData] = useState(null);\n  const [isPremium, setIsPremium] = useState(false); // New state for premium status\n\n  // Initialize RevenueCat SDK once when the component mounts\n  useEffect(() => {\n    const revenueCatApiKey = process.env.REACT_APP_REVENUECAT_PUBLIC_API_KEY; // Replace with your actual RevenueCat public API key from .env.local or your build process. Find it in RevenueCat Dashboard -> API Keys.\n\n    const unsubscribe = auth.onAuthStateChanged(async user => { // Made async to await Purchases.getCustomerInfo()\n      setCurrentUser(user);\n      setLoading(false);\n\n      if (revenueCatApiKey && user && !Purchases.isConfigured) {\n        Purchases.configure({ apiKey: revenueCatApiKey, appUserID: user.uid });\n        console.log(\"RevenueCat SDK configured.\");\n      }\n\n      if (user) {\n        // Fetch RevenueCat customer info to determine premium status\n        try {\n          const customerInfo = await Purchases.getCustomerInfo();\n          if (customerInfo.entitlements.active.premium) { // Assuming 'premium' is your entitlement ID\n            setIsPremium(true);\n            console.log(\"User is premium.\");\n          } else {\n            setIsPremium(false);\n            console.log(\"User is not premium.\");\n          }\n        } catch (e) {\n          console.error(\"Error fetching RevenueCat customer info:\", e);\n          setIsPremium(false); // Assume not premium on error\n        }\n        setView('main');\n      } else {\n        setIsPremium(false); // Reset premium status on logout\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const handleLogout = () => {\n    auth.signOut().then(() => {\n      setView('welcome');\n      setJoinToken(null);\n      setBubbleCreationData(null);\n    });\n  };\n\n  const handleLoginBack = () => {\n    if (joinToken) {\n      setView('join');\n    } else if (bubbleCreationData) {\n      setView('create');\n    } else {\n      setView('welcome');\n    }\n  };\n\n  const resetAuthFlow = () => {\n    setView('login');\n    setJoinToken(null);\n    setBubbleCreationData(null);\n  }\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-gray-950 via-gray-900 to-blue-950 flex items-center justify-center\">\n        <div className=\"w-16 h-16 border-4 border-t-transparent border-blue-500 rounded-full animate-spin\"></div>\n      </div>\n    );\n  }\n\n  if (!currentUser) {\n    if (view === 'welcome') {\n      return <Welcome \n                onLogin={resetAuthFlow} \n                onCreate={() => setView('create')}\n                onJoin={() => setView('join')} \n              />;\n    }\n    if (view === 'join') {\n      return <JoinBubble \n                onJoin={(token) => { setJoinToken(token); setView('login'); }} \n                onBack={() => setView('welcome')} \n              />;\n    }\n    if (view === 'create') {\n      return <CreateBubbleFlow \n                onComplete={(data) => { setBubbleCreationData(data); setView('login'); }}\n                onBack={() => setView('welcome')}\n                isPremium={isPremium} // Pass isPremium prop\n              />;\n    }\n    if (view === 'login') {\n      return <Login onLoginSuccess={() => setView('main')} onBack={handleLoginBack} />;\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-950\">\n      <MainApp \n        userId={currentUser.uid} \n        onLogout={handleLogout} \n        joinToken={joinToken} \n        bubbleCreationData={bubbleCreationData}\n        onBubbleCreated={() => setBubbleCreationData(null)}\n      />\n    </div>\n  );\n}"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAClD,SAASC,IAAI,QAAQ,YAAY;AACjC,OAAOC,OAAO,MAAM,6BAA6B;AACjD,OAAOC,OAAO,MAAM,2BAA2B;AAC/C,OAAOC,KAAK,MAAM,yBAAyB;AAC3C,OAAOC,UAAU,MAAM,8BAA8B;AACrD,OAAOC,gBAAgB,MAAM,oCAAoC;AACjE,OAAOC,SAAS,MAAM,eAAe;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAEtC,eAAe,SAASC,eAAeA,CAAA,EAAG;EAAAC,EAAA;EACxC,MAAM,CAACC,WAAW,EAAEC,cAAc,CAAC,GAAGd,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAACe,OAAO,EAAEC,UAAU,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACiB,IAAI,EAAEC,OAAO,CAAC,GAAGlB,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC;EAC7C,MAAM,CAACmB,SAAS,EAAEC,YAAY,CAAC,GAAGpB,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACqB,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGtB,QAAQ,CAAC,IAAI,CAAC;EAClE,MAAM,CAACuB,SAAS,EAAEC,YAAY,CAAC,GAAGxB,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC;;EAEnD;EACAC,SAAS,CAAC,MAAM;IACd,MAAMwB,gBAAgB,GAAGC,OAAO,CAACC,GAAG,CAACC,mCAAmC,CAAC,CAAC;;IAE1E,MAAMC,WAAW,GAAG3B,IAAI,CAAC4B,kBAAkB,CAAC,MAAMC,IAAI,IAAI;MAAE;MAC1DjB,cAAc,CAACiB,IAAI,CAAC;MACpBf,UAAU,CAAC,KAAK,CAAC;MAEjB,IAAIS,gBAAgB,IAAIM,IAAI,IAAI,CAACvB,SAAS,CAACwB,YAAY,EAAE;QACvDxB,SAAS,CAACyB,SAAS,CAAC;UAAEC,MAAM,EAAET,gBAAgB;UAAEU,SAAS,EAAEJ,IAAI,CAACK;QAAI,CAAC,CAAC;QACtEC,OAAO,CAACC,GAAG,CAAC,4BAA4B,CAAC;MAC3C;MAEA,IAAIP,IAAI,EAAE;QACR;QACA,IAAI;UACF,MAAMQ,YAAY,GAAG,MAAM/B,SAAS,CAACgC,eAAe,CAAC,CAAC;UACtD,IAAID,YAAY,CAACE,YAAY,CAACC,MAAM,CAACC,OAAO,EAAE;YAAE;YAC9CnB,YAAY,CAAC,IAAI,CAAC;YAClBa,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC;UACjC,CAAC,MAAM;YACLd,YAAY,CAAC,KAAK,CAAC;YACnBa,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;UACrC;QACF,CAAC,CAAC,OAAOM,CAAC,EAAE;UACVP,OAAO,CAACQ,KAAK,CAAC,0CAA0C,EAAED,CAAC,CAAC;UAC5DpB,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;QACvB;QACAN,OAAO,CAAC,MAAM,CAAC;MACjB,CAAC,MAAM;QACLM,YAAY,CAAC,KAAK,CAAC,CAAC,CAAC;MACvB;IACF,CAAC,CAAC;IACF,OAAO,MAAMK,WAAW,CAAC,CAAC;EAC5B,CAAC,EAAE,EAAE,CAAC;EAEN,MAAMiB,YAAY,GAAGA,CAAA,KAAM;IACzB5C,IAAI,CAAC6C,OAAO,CAAC,CAAC,CAACC,IAAI,CAAC,MAAM;MACxB9B,OAAO,CAAC,SAAS,CAAC;MAClBE,YAAY,CAAC,IAAI,CAAC;MAClBE,qBAAqB,CAAC,IAAI,CAAC;IAC7B,CAAC,CAAC;EACJ,CAAC;EAED,MAAM2B,eAAe,GAAGA,CAAA,KAAM;IAC5B,IAAI9B,SAAS,EAAE;MACbD,OAAO,CAAC,MAAM,CAAC;IACjB,CAAC,MAAM,IAAIG,kBAAkB,EAAE;MAC7BH,OAAO,CAAC,QAAQ,CAAC;IACnB,CAAC,MAAM;MACLA,OAAO,CAAC,SAAS,CAAC;IACpB;EACF,CAAC;EAED,MAAMgC,aAAa,GAAGA,CAAA,KAAM;IAC1BhC,OAAO,CAAC,OAAO,CAAC;IAChBE,YAAY,CAAC,IAAI,CAAC;IAClBE,qBAAqB,CAAC,IAAI,CAAC;EAC7B,CAAC;EAED,IAAIP,OAAO,EAAE;IACX,oBACEL,OAAA;MAAKyC,SAAS,EAAC,wGAAwG;MAAAC,QAAA,eACrH1C,OAAA;QAAKyC,SAAS,EAAC;MAAmF;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAM;IAAC;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtG,CAAC;EAEV;EAEA,IAAI,CAAC3C,WAAW,EAAE;IAChB,IAAII,IAAI,KAAK,SAAS,EAAE;MACtB,oBAAOP,OAAA,CAACN,OAAO;QACLqD,OAAO,EAAEP,aAAc;QACvBQ,QAAQ,EAAEA,CAAA,KAAMxC,OAAO,CAAC,QAAQ,CAAE;QAClCyC,MAAM,EAAEA,CAAA,KAAMzC,OAAO,CAAC,MAAM;MAAE;QAAAmC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC/B,CAAC;IACZ;IACA,IAAIvC,IAAI,KAAK,MAAM,EAAE;MACnB,oBAAOP,OAAA,CAACJ,UAAU;QACRqD,MAAM,EAAGC,KAAK,IAAK;UAAExC,YAAY,CAACwC,KAAK,CAAC;UAAE1C,OAAO,CAAC,OAAO,CAAC;QAAE,CAAE;QAC9D2C,MAAM,EAAEA,CAAA,KAAM3C,OAAO,CAAC,SAAS;MAAE;QAAAmC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAClC,CAAC;IACZ;IACA,IAAIvC,IAAI,KAAK,QAAQ,EAAE;MACrB,oBAAOP,OAAA,CAACH,gBAAgB;QACduD,UAAU,EAAGC,IAAI,IAAK;UAAEzC,qBAAqB,CAACyC,IAAI,CAAC;UAAE7C,OAAO,CAAC,OAAO,CAAC;QAAE,CAAE;QACzE2C,MAAM,EAAEA,CAAA,KAAM3C,OAAO,CAAC,SAAS,CAAE;QACjCK,SAAS,EAAEA,SAAU,CAAC;MAAA;QAAA8B,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACvB,CAAC;IACZ;IACA,IAAIvC,IAAI,KAAK,OAAO,EAAE;MACpB,oBAAOP,OAAA,CAACL,KAAK;QAAC2D,cAAc,EAAEA,CAAA,KAAM9C,OAAO,CAAC,MAAM,CAAE;QAAC2C,MAAM,EAAEZ;MAAgB;QAAAI,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC;IAClF;EACF;EAEA,oBACE9C,OAAA;IAAKyC,SAAS,EAAC,0BAA0B;IAAAC,QAAA,eACvC1C,OAAA,CAACP,OAAO;MACN8D,MAAM,EAAEpD,WAAW,CAACuB,GAAI;MACxB8B,QAAQ,EAAEpB,YAAa;MACvB3B,SAAS,EAAEA,SAAU;MACrBE,kBAAkB,EAAEA,kBAAmB;MACvC8C,eAAe,EAAEA,CAAA,KAAM7C,qBAAqB,CAAC,IAAI;IAAE;MAAA+B,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACpD;EAAC;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACC,CAAC;AAEV;AAAC5C,EAAA,CAjHuBD,eAAe;AAAAyD,EAAA,GAAfzD,eAAe;AAAA,IAAAyD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}